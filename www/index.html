<!DOCTYPE html>
<html style="height: 100%"><head>
<meta charset="utf-8"/>
<link rel='icon' href='/favicon.ico' type='image/x-icon'/>
<title>Inherit the Stars!</title>
<style>
body { 
    background-color: rgb(0, 0, 44);
    background-image: url("background.jpg");
    background-attachment: fixed;
    background-size: cover;
    font-family: sans-serif;
    font-weight: bold;
    color: white; 
    text-shadow: 0 0 3px black;
    height: 100%;
    margin: 0;
}
.vfill {
    height: 100%;
}
div.center_middle {
    margin: 0;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
div.title_screen {
    color: silver;
    font-weight: bold;
    text-align: center;
    text-shadow: 0 0 10px black, 0 0 15px white;
}
div.title_small {
    padding: 14px;
    text-align: right;
    color: silver;
    font-size: 180%;
    text-shadow: 0 0 10px black, 0 0 15px white;
    display: none;
}
div.input {
    width: 600px;
    margin: auto;
}
button {
    font-size: 100%;
    font-weight: bold;
    border: none;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    transition-duration: 0.4s;
    cursor: pointer;
    background-color: rgba(0, 0, 44, 0.5);
    color: white; 
    text-shadow: 0 0 3px black;
    border: 2px solid white;
}
button:hover {
    background-color: silver;
    color: black;
    text-shadow: 0 0 3px white;
}
button.selected {
    background-color: white;
    color: black;
    text-shadow: 0 0 3px silver;
}
button.sidebar {
    padding: 16px 32px;
    width: 100%;
    white-space: nowrap;
}
button.screen_button {
    margin-top: 20px;
    padding: 8px 16px;
}
button.tab_button {
    padding-right: 1em;
}
button.circle {
    width: 27px;
    height: 27px;
    padding: 0;
    margin-left: 10px;
    border-radius: 50%;
}
table {
    border: 0;
}
input.label {
    color: white;
    background-color: Transparent;
    border: 0;
}
</style>
<script>
function show_screen(show) {
    // Hide all screens
    for(screen of document.getElementsByClassName('screen')) {
        screen.style.display = 'none';
    }
    // Show selected screen
    document.getElementById(show + '_screen').style.display = 'block';
    // Show/hide small title
    if(show == 'title') {
        document.getElementById('title_small').style.display = 'none';
    } else {
        document.getElementById('title_small').style.display = 'block';
        // Reset tabs and load defaults
        if(show == 'new_game') {
            submit(show, false, true);
            show_tab('new_game_galaxy');
        } else if(show == 'load_game') {
            submit(show, false, true);
            show_tab('load_game');
        } else if(show == 'launch') {
            submit(show, false, true);
            show_tab('launch');
        }
    }
    for(button of document.getElementsByClassName('sidebar')) {
        button.classList.remove('selected');
    }
    document.getElementById(show + '_sidebar').classList.add('selected');
}

function show_tab(show) {
    for(tab of document.getElementsByClassName('tab')) {
        tab.style.display = 'none';
    }
    document.getElementById(show + '_tab').style.display = 'block';
    for(button of document.getElementsByClassName('tab_button')) {
        button.classList.remove('selected');
    }
    document.getElementById(show + '_tab_button').classList.add('selected');
}

function submit(form) {
    submit(form, false, false);
}

function submit(form, save) {
    submit(form, save, false);
}

function submit(form, save, reset) {
    var values = {};
    if(reset) {
        values['reset'] = true;
    } else {
        for(input of document.getElementsByClassName(form + '_input')) {
            if(input.matches('[type="checkbox"]')) {
                values[input.id] = input.checked;
            } else {
                values[input.id] = input.value;
            }
        }
        if(save) {
            values['submit'] = true;
        }
    }
    fetch('/' + form, { method: 'post', body: JSON.stringify(values) }).then(function(response) {
        return response.json();
    }).then(function(json) {
        for(key in json) {
            input = document.getElementById(key);
            if(input != null) {
                if(input.nodeName == 'SELECT') {
                    var options = []
                    for(var i = 0; i < input.length; i++) {
                        options.push(input.options[i].text);
                    }
                    for(opt_text of json['options_' + key]) {
                        if(!options.includes(opt_text)) {
                            var new_option = document.createElement("option");
                            new_option.text = opt_text;
                            input.add(new_option); 
                        }
                        options.splice(options.indexOf(opt_text), 1);
                    }
                    for(opt_text in options) {
                        for(var i = 0; i < input.length; i++) {
                            if(input.options[i].text == opt_text) {
                                input.remove(i);
                                break;
                            }
                        }
                    }
                    input.value = json[key];
                } else if(input.matches('[type="checkbox"]')) {
                    input.checked = json[key];
                } else {
                    input.value = json[key];
                }
            }
        }
    })
}

function shutdown() {
    if(confirm('Shutdown?')) {
        show_screen('shutdown');
        fetch('/shutdown', { method: 'post' });
    }
}
</script>
</head><body>
<table class="vfill"><tr><td><table class="vfill">
    <tr><td><button class="sidebar" id="new_game_sidebar" onclick="show_screen('new_game')">New Game</button></td></tr>
    <tr><td><button class="sidebar" id="load_game_sidebar" onclick="show_screen('load_game')">Load Game</button></td></tr>
    <tr><td><button class="sidebar" id="launch_sidebar" onclick="show_screen('launch')">Launch</button></td></tr>
    <tr><td><button class="sidebar" id="race_editor_sidebar" onclick="show_screen('race_editor')">Race Editor</button></td></tr>
    <tr><td class="vfill"></td></tr>
    <tr><td><button class="sidebar" id="help_sidebar" onclick="show_screen('help')">Help</button></td></tr>
    <tr><td><button class="sidebar" id="shutdown_sidebar" onclick="shutdown()">Shutdown</button></td></tr>
</table></td><td style="width: 100%; vertical-align: top">
    <div class="title_small" id="title_small">INHERIT THE STARS!</div>

    <div class="screen" id="help_screen" style="display: none">
        Put stuff here
    </div>

    <div class="screen input" id="new_game_screen" style="display: none">
        <button class="tab_button" id="new_game_galaxy_tab_button" onclick="show_tab('new_game_galaxy')">Galaxy</button>
        <button class="tab_button" id="new_game_players_tab_button" onclick="show_tab('new_game_players')">Players</button>
        <button class="tab_button" id="new_game_victory_tab_button" onclick="show_tab('new_game_victory')">Victory Conditions</button>
        <div style="border: 2px solid white; padding: 6px; padding-right: 12px">
            <div class="tab" id="new_game_galaxy_tab">
                Game Name<br/>
                <input class="new_game_input" type="text" id="new_game_name" style="width: 100%" onchange="submit('new_game')"></input><br/><br/>
                Diameter of the galaxy (in ly): X axis<br/>
                <input class="new_game_input" type="number" min="0" max="100" id="new_game_x" style="width: 100%" onchange="submit('new_game')"></input><br/><br/>
            </div>
            <div class="tab" id="new_game_players_tab" style="display: none">
                players
            </div>
            <div class="tab" id="new_game_victory_tab" style="display: none">
                victory
            </div>
        </div>
        <div style="text-align: right">
            <button class="screen_button" onclick="submit('new_game', true)">Create</button>
            <button class="screen_button" onclick="reset_new_game()">Reset</button>
        </div>
    </div>

    <div class="screen input" id="load_game_screen" style="display: none">
        <button class="tab_button" id="load_game_tab_button" onclick="show_tab('load_game_tab')">Game</button>
        <div style="border: 2px solid white; padding: 6px; padding-right: 12px">
            <div class="tab" id="load_game_tab">
                Game Name<br/>
                <select class="load_game_input" id="load_game_list" style="width: 100%" onchange="submit('load_game')"></select><br/><br/>
                <input class="load_game_input" type="checkbox" id="load_game_auto" onchange="submit('load_game')"></input> Auto Generate<br/><br/>
                <table style="padding-left: 15px">
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player01" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player01_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player02" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player02_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player03" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player03_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player04" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player04_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player05" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player05_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player06" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player06_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player07" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player07_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player08" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player08_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player09" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player09_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player10" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player10_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player11" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player11_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player12" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player12_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player13" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player13_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player14" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player14_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player15" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player15_status" disabled="true"></input></td>
                    </tr>
                    <tr>
                        <td style="width: 100%"><input class="load_game_input label" type="text" id="load_game_player16" disabled="true"></input></td>
                        <td><input class="load_game_input label" type="text" id="load_game_player16_status" disabled="true"></input></td>
                    </tr>
                </table>
            </div>
        </div>
        <div style="text-align: right">
            <button class="screen_button" onclick="submit('load_game', true)">Load Game</button>
            <button class="screen_button" onclick="alert('generate')">Generate Now</button>
        </div>
    </div>

    <div class="screen input" id="launch_screen" style="display: none">
        <button class="tab_button" id="launch_tab_button" onclick="show_tab('launch_tab')">Game</button>
        <div style="border: 2px solid white; padding: 6px; padding-right: 12px">
            <div class="tab" id="launch_tab">
                Game Name<br/>
                <input class="launch_input label" type="text" id="launch_game" disabled="true"></input><br/><br/>
                <select class="launch_input" id="launch_player" style="width: 100%" onchange="submit('launch')"></select><br/>
                <input class="launch_input label" type="text" id="launch_player_status" disabled="true"></input><br/><br/>
            </div>
        </div>
        <div style="text-align: right">
            <button class="screen_button" onclick="submit('launch', true)">Launch Player</button>
        </div>
    </div>

    <div class="screen input" id="race_editor_screen" style="display: none">
        TODO<br/>
        <div style="text-align: right">
            <button class="screen_button" onclick="submit('race_editor', true)">Save</button>
            <button class="screen_button" onclick="reset_race_editor()">Reset</button>
        </div>
    </div>

</td></tr></table>

<div class="screen center_middle title_screen" id="title_screen">
    <div style="font-size: 600%">INHERIT THE</div>
    <div style="font-size: 1050%">STARS!</div>
</div>

<div class="screen center_middle" id="shutdown_screen" style="display: none; font-size: 300%">
    Thank you for playing
</div>

</body></html>
